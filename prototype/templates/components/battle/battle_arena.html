<!-- Battle Arena Component -->
<div class="battle-overlay" id="battleOverlay">
    <div class="battle-container">
        <div class="battle-header">
            <h2>Battle Arena</h2>
        </div>
        
        <div class="battle-stage">
            <div class="battle-background"></div>
            
            <div class="player-section">
                <div class="character player-character">
                    <div class="character-sprite"></div>
                    <div class="character-effects"></div>
                </div>
                
                <div class="player-stats">
                    <div class="stat-name">{{ player_username }}</div>
                </div>
            </div>

            <div class="vs-section">
                <div class="vs-decoration left"></div>
                <div class="vs-text medieval-text">VS</div>
                <div class="vs-decoration right"></div>
                <div class="battle-duration medieval-text">
                    <i class="fas fa-hourglass-half"></i>
                    <span id="battleTimer">00:00</span>
                </div>
            </div>

            <div class="enemy-section">
                <div class="character enemy-character" id="currentEnemy">
                    <div class="character-sprite"></div>
                    <div class="character-effects"></div>
                </div>
                <div class="enemy-stats">
                    <div class="stat-name">Enemy</div>
                </div>
            </div>
        </div>

        <button type="button" id="attack-button" class="rpg-button" tabindex="0">
            <i class="fas fa-sword fa-lg"></i>
            <span class="task-text">
                <span class="enemy-name">Start Battle</span>
            </span>
            <span class="click-effect"></span>
        </button>
        <div class="enemy-queue" id="enemyQueue"></div>
    </div>
</div>  

<!-- Trigger Button -->
<button id="showBattleBtn" class="show-battle-btn medieval-text">Start Battle</button>

<script>
window.addEventListener('DOMContentLoaded', () => {
    const button = document.getElementById('attack-button');
    
    function createRipple(event) {
        const button = event.currentTarget;
        const ripple = button.querySelector('.click-effect');
        
        // Reset animation
        ripple.style.animation = 'none';
        ripple.offsetHeight; // Trigger reflow
        ripple.style.animation = null;
        
        // Set ripple position based on click or center
        if (event.type === 'click') {
            const rect = button.getBoundingClientRect();
            const x = event.clientX - rect.left;
            const y = event.clientY - rect.top;
            ripple.style.left = `${x}px`;
            ripple.style.top = `${y}px`;
        } else {
            // Center for keyboard
            ripple.style.left = '50%';
            ripple.style.top = '50%';
        }
        
        ripple.classList.add('animate');
        
        // Add pressed class
        button.classList.add('pressed');
        
        // Remove classes after animation
        setTimeout(() => {
            ripple.classList.remove('animate');
            button.classList.remove('pressed');
        }, 600);
    }

    button.addEventListener('click', createRipple);
    button.addEventListener('keydown', (e) => {
        if (e.code === 'Space' || e.code === 'Enter') {
            e.preventDefault();
            createRipple(e);
            button.classList.add('keyboard-pressed');
        }
    });
    
    button.addEventListener('keyup', (e) => {
        if (e.code === 'Space' || e.code === 'Enter') {
            e.preventDefault();
            button.classList.remove('keyboard-pressed');
        }
    });
});
</script>
